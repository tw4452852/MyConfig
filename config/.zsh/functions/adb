local args devices d
typeset -A devices_map

args=("$@")

if [[ -n ${args[(r)-s]} ]]; then
	command adb $args
	return
fi

devices=("${(f)$(command adb devices)}")
devices[1]=()

if (( ${#devices} <= 1 )); then
	command adb $args
	return
fi

devices_map=${(z)devices[@]}

select d in ${(k)devices_map}; do
	command adb -s $d $args
	return
done
